
# 提要

- 在python中，经常会提到io密集型任务可以用多线程提速，cpu密集型可以用多进程提速
- io密集型任务、cpu密集型任务有哪些
- 多线程一定能提速io密集型任务吗
- python多线程、多进程、协程是为了解决什么


# 起源

q：多线程读取本地硬盘多个文件，是否能加速？  

a：不能，磁盘读取速度瓶颈，多线程和同步代码读文件速度一样，甚至多线程会增加cpu 2ms一次的线程切换资源消耗  

q：多线程读文件的同时，有写入远程数据库的操作，加速？  

a：可以，写入数据库有io等待，数据库可以并行写入，直到数据库写入速度上限  

**多线程是否能加速，取决于和程序交互的对象工作方式和性能**


## io密集型任务

- 从硬盘驱动器读取或写入文件
- 读取或写入标准输出、输入或错误（stdin、stdout、stderr）
- 打印文档
- 下载或上传文件
- 查询服务器
- 查询数据库
- 拍照或录制视频
- ...


## cpu密集型任务

- 计算分形中的点
- 估计 Pi
- 因式分解素数
- 解析 HTML、JSON 等文档
- 处理文本
- 运行模拟
- ...


## python多线程、多进程、协程是为了解决什么问题

- 多线程和协程为了 io等待时，当前进程线程的cpu 内存等硬件资源处理其他任务
- 多进程为了多核cpu 并行执行某些计算任务

### 协程

- 底层利用os epoll(select poll epoll)，yield
- await只能修饰async function
- async关键字是为了让python asyncio 以事件循环的方式执行代码，否则默认同步执行代码
- 没有await的async对象宏观上无异于同步代码


**[io-cpu密集型任务来源](https://superfastpython.com/thread-vs-process/#When_to_Use_Threads)**
